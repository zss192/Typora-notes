# 引言

## 知识点

1.在本书中，c指密文，m指明文，E()表示加密函数，D()表示解密函数

2.仿射变换：加密和解密中a，b为秘钥

c=E~a,b~(m)=am+b(mod 26)

m=D~a,b~(m)=a^-1^(c-b)(mod 26)      

> 注意a^-1^*a≡1 mod 26

3.多表代换密码：其中A为n*n的矩阵，n等于几代表明文每几个分成一组。一般N为26。

C~i~≡AM~i~+B(mod N)，i=1,2,3....

M~i~≡A^-1^(C~i~-B)(mod N)，i=1,2,3....

## 习题

1.设由仿射变换对一个明文加密得到的密文为edsgickxhuklzveqzvkxwkzukvcuh，又已知明文的前两个字符是“if"，对该密文解密。

答：e=4  d=3  i=8   f=5    （26个字母下标从0开始）E~a,b~(m)=am+b(mod 26)

E(i)=e，4≡8*a+b(mod 26)

E(f)=d，3≡5*a+b(mod 26)

由上述两个式子可推出a=9，b=10，所以m=9^-1^(c-10)(mod 26)

<img src="https://cdn.jsdelivr.net/gh/zss192/Typora-notes@latest/images/image-20200609204054393.png" alt="image-20200609204054393" style="zoom:80%;" />

2.设多表代换密码C≡AM~i~+ B(mod26)中，A是2X2矩阵，B是0矩阵，又知明文“dont”被加密为“elni”，求矩阵A。

<img src="https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20200609205229494.png" alt="image-20200609205229494" style="zoom:67%;" />

> 注意矩阵相乘的结果要模26，上式求b的时候算得125b=13，其实应是125b≡13(mod 26)，即为21b≡13(mod 26)，解得b=13，其他类似

# 流密码

## 知识点

1.流密码中密钥流就等于明文串和密文串异或

## 习题

1.求矩阵的逆（这章习题会用到，复习下）

核心公式：A^-1^=A^*^/|A|

<img src="https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20200609214703300.png" alt="image-20200609214703300" style="zoom:80%;" />

若是三阶矩阵：A~ij~=(-1)^i+j^M~ij~，M~ij~为除去a~ij~所在那一行和那一列得到的二阶矩阵

![image-20200609215140551](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20200609215140551.png)

![image-20200609215521885](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20200609215521885.png)

![image-20200609215736609](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@latest/images/image-20200609215736609.png)

![image-20200609215941959](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@latest/images/image-20200609215941959.png)

2.已知流密码的密文串1010110110和相应的明文串0100010001，而且还已知密钥流是使用3级线性反馈移位寄存器产生的，试破译该密码系统。(和P65例2-6类似)

答：由已知可得密钥流为1010110110⊕0100010001=1110100111，因为是3级线性反馈

![image-20200609212249326](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20200609212249326.png)

![image-20200609214235084](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20200609214235084.png)

> 记住c从高到低，a从低到高

3.如图是一个3级反馈移位寄存器，其初始状态为(a1,a2,a3)=(1,0,1)，求输出序列

<img src="https://cdn.jsdelivr.net/gh/zss192/Typora-notes@latest/images/image-20200609221112648.png" alt="image-20200609221112648" style="zoom:80%;" />

从图中可看到a1、a2、a3经f函数送至左边形成一个循环，比如f(a1,a2,a3)=b，那么b将代替a3的位置，a3～a1均右移，所以a1输出，以此类推。

答：f(a1,a2,a3)=f(1,0,1)=1*0⊕1=1，然后f(1,1,0)

可总结规律，右边的3为参与f函数生成的数放在左边，然后以左边这个数向右数3个数分别当做a3,a2,a1参与f生成的又放在最左边......最后输出是从右到左

<img src="https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/IMG_20200609_222216.jpg" alt="IMG_20200609_222216" style="height:170px;" />

即输出序列为10111011101.....，周期为4