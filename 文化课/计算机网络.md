# 题型及复习说明

题型及分值分布
一、单选题(本题共10题,每题2分,共20分)
二、填空题(本题共10题,每题2分,共20分
三、问答题(本题共5题,每题6分,共30分)
四、综合应用题(本题共2题,共30分)

考试重点章节
1.第三、四、五章是重点章节
2.自学、探研报告、实验相关内容都需要看看
3.重点的概念要求一定理解到位,不能死背概念

# 计算机网络体系结构

## 老师所画重点

1.计算机网络的概念和分类
2.计算机网络两种通信方式(C/S、P2P)
3.互联网的组成,分组交换技术的要点、优点。
4.协议的概念、三要素
5.网络的主要性能指标的含义、计算及相关应用(带宽、时延、往返时延、利用率等)。
6.体系结构的概念、标准,OSI和TCP/IP的层次模型

## 知识点

1.计算机网络：是一个将分散的、具有独立功能的计算机系统，通过通信设备与线路连接起来，由功能完善的软件实现资源共享和信息传递的系统

2.计算机网络的组成

- 物理组成上看可分为硬件、软件、协议(可理解为一种规则)。
- 工作方式上看可分为**边缘部分**(由主机组成)和**核心部分**(由网络和路由器组成,为边缘部分提供服务)。
- 逻辑功能上看可分为通信子网(数据传输和通信)和资源子网(终端、资源和服务)。
  - 通信子网包括物理层、数据链路层和网络层。

3.计算机网络的功能

- **数据通信**(最基本和最重要的功能)
  - 包括流量控制、路由选择、传输控制
- 资源共享：可共享硬件、软件、数据
- 分布式处理：多个主机各自承担同一任务的不同部分，如Hadoop
- 信息综合处理：将分散的数据集中处理或分级处理
- 负载均衡：将工作任务均衡的分配给网络中各计算机
- 提高可靠性：网络中个计算机可通过网络互为替换机

4.计算机网络的分类

![image-20201207083410816](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201207083410816.png)

其中按范围划分

| 局域网 | 几千米内如学校 |
| ------ | -------------- |
| 城域网 | 一个城市       |
| 广域网 | 一个国家或大洲 |

5.计算机网络为什么要采用分层结构：各层之间相互独立、灵活性好、易于实现和标准化。

> 助记：一个公司如果非常大肯定要分部门工作，但要只有两三个人就没必要细分了。

6.协议：一种规则用来控制**两个对等**(同一层)实体通信。

- 语法：结构或格式即怎么讲
- 语义：发出何种控制信息以及做出什么响应即讲什么
- 同步：规定执行顺序

7.接口：**上层使用下层**服务的入口即服务访问点(SAP)（类似于程序里的接口）

8.服务：下层为相邻上层提供的功能调用。(协议是水平的而服务是垂直的)

> 助记：肯定是你为领导服务

- 面向连接的服务和面向无连接的服务
  - 连接：通信前先建立连接比较可靠如TCP；无连接：不连接直接发速度快但可能丢包如UDP
- 可靠服务(数据一定准确送达)和不可靠服务(尽力而为)
- 有应答服务(收到数据后给发送方说下)和无应答服务（了解）

9.下一层对上一层提供的服务对上一层透明

> 透明：打游戏你负责玩就行，你不用知道这游戏是咋实现的

10.OSI七层结构

![image-20201207091242863](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201207091242863.png)

![image-20201207172709968](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201207172709968.png)

![image-20201207172709969](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/4039680_1523328974264_E4E1F3318AF5F32719A15808E8D8458B)

11.OSI5层结构总结

|              | 应用层                                 | 传输层                                                  | 网络层                                                       | 数据链路层                                              | 物理层                       |
| ------------ | -------------------------------------- | ------------------------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------- | ---------------------------- |
|              | 用户对用户(端到端)                     | 应用对应用；进程对进程(**端到端**)                      | 主机对主机(点到点)                                           | 点到点                                                  | 点到点                       |
| 传输单位     | ——                                     | 报文段(TCP)或用户数据报(UDP)                            | IP数据报                                                     | 帧                                                      | 比特                         |
| 所实现的硬件 | ——                                     | ——                                                      | 路由器                                                       | 交换机、网桥                                            | 集线器、中继器               |
| 任务         | 提供系统与用户的接口(如QQ)             | 负责主机中两个进程之间的通信                            | 1.将传输层传来的报文段封装成分组;2.选择适当的路由使分组能够交付到目的主机 | 将网络层传来的IP数据报组装成帧                          | 透明的传输比特流             |
| 功能         | 1.文件传输;2.访问和管理;3.电子邮件服务 | 1.可靠传输、不可靠传输;2.流量控制;3.差错控制;4.复用分用 | 1.路由选择;2.流量控制;3.差错控制;4.拥塞控制                  | 1.成帧(定义开始和结束);2.差错控制;3.流量控制;4.访问控制 | 为数据端设备提供传送数据通路 |
| 协议         | FTP、SMTP、POP3、HTTP                  | TCP、UDP、ARQ                                           | ICMP、ARP、RARP、IP、IGMP                                    | PPP、HDLC                                               | ——                           |

12.OSI参考模型和TCP/IP模型对比

| OSI参考模型                   | TCP/IP模型                                       |
| ----------------------------- | ------------------------------------------------ |
| 3个主要概念：服务、接口、类型 | 没有明确区分服务、接口、类型                     |
| 产生在协议发明之前            | 产生在协议发明之后                               |
| 共有7层                       | 一定是4层(一般教材为了更好的讲解才按5层模型讲解) |
| 网络层：连接和无连接          | 网络层：仅有无连接                               |
| 传输层：仅有面向连接          | 传输层：面向连接和无连接                         |

13.计算机网络性能指标

- 带宽：网络设备可支持的最高速度(b/s)
- 时延：数据从一端传到另一端所需要的时间
  - 发送时延(传输时延)：从**发送数据**第一位到最后一位发送完毕所需时间
    - 发送时延 = 数据帧长度(bit)  /  发送速率(bit/s)
  - 传播时延：电磁波在**信道中传播**一定距离所需时间
    - 传播时延 = 信道长度(m)  /  电磁波在信道上的传播速度(m/s)
  - 排队时延：在输入和输出队列中**排队等待处理**所需时间
  - 处理时延：主机或路由器收到分组进行处理所需时间
  - 总时延 = 发送时延+传播时延+排队时延+处理时延
- 时延带宽积：又称以比特为单位的链路长度即某段链路现有多少比特(容量)
  - 时延带宽积(bit) = 传播时延(s) x 带宽(bit/s)
- 往返时延(RTT)：数据发送后来回跑一趟的时间
  - 往返时延 = 2x传播时延+末端处理时间
- 信道利用率 = 有数据通过时间  /  (有+无)数据通过时间
- 网络利用率：信道利用率加权平均值

14.两种通信方式

- C/S(客户-服务器)方式：客户是服务请求方，服务器是服务提供方，指的都是进程不是使用者
- P2P(peer-to-peer)方式：任一主机既可以是客户也同时可以是服务器

15.TCP/IP协议栈

![image-20201228020146368](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201228020146368.png)

## 习题

1.下列选项中，不属于网络体系结构所描述的内容是（C）

A.网络的层次	B.每一层使用的协议	C.协议的内部实现细节	D.每一层必须完成的功能

答：层次、协议、完成的功能教材均有提及，内部细节这是工作人员去实现就行

2.下列属于通信子网的是（A）

I.网桥	II.交换机	III.计算机软件	IV.路由器

A. I、II、IV		B. II、III、IV	......

答：通信子网是负责通信的而且只包括物理层、数据链路层、网络层。计算机软件显然不是用于通信的工具也不在那三层里面，它属于资源子网。

3.局域网和广域网之间的差异是（D）

A.所使用的传输介质不同		B.所覆盖的范围不同

C.所使用的协议不同		D.B和C

答：我们都知道他俩范围肯定不一样。至于协议不同是因为广域网范围更广，信号可靠度不高就要采取一系列差错控制、流量控制等手段，而局域网信道质量较好主要实现信道复用和提高速度就行。传输介质可能都是光纤。

4.下列说法错误的是（C）

I.广播式网络一般只包含3层，即物理层、数据链路层和网络层
II. Internet 的核心协议是TCP/IP
III.在Internet中，网络层的服务访问点是端口号

A. I、II、III	B. III	C. I、III	D. I、II

答：广播式网络谁都发不存在路由选择的问题，所以没有网络层

网络层的服务访问点是IP地址，传输层的服务访问点才是端口号

5.在n个节点的星型拓扑结构中，有（A）条物理链路

A.n-1	B.n	C.nx(n-1)	D.nx(n+1)/2

答：星型拓扑是中间一个点与外边一圈的点相连，所以是n-1

而在型拓扑结构中是n条链路

6.在TCP/IP体系结构中，**直接**为ICMP提供服务的协议是（B）

A．PPP	B．IP	C．UDP	D．TCP

答：网际控制报文协议ICMP是TCP/IP体系结构网络层中的一个协议，ICMP报文需要使用IP协议封装为IP数据报，因此可以认为直接为ICMP提供服务的协议是IP协议。

PPP协议在TCP/IP体系结构中属于最底层协议，也就是网络接口层协议；在OSI体系中属于数据链路层协议，所以PPP协议为网络层提供服务，但并不能认为PPP直接为ICMP提供服务。

UDP和TCP都属于传输层协议，它们为应用层提供服务。

> 本题关键字在于“直接“，一般协议都是为上一层提供服务

7.在OSI参考模型中，下列功能需由应用层的相邻层实现的是（B）

A．对话管理			B．数据格式转换

C．路由选择			D．可靠数据传输

答：应用层的相邻层是表示层。表示层的任务主要是数据字符集的转换、数据格式化、文本压缩、数据加密以及解密等工作。

选项A中的**对话**管理，是**会话**层实现的功能；

选项C中的路由选择，是网络层实现的功能；

选项D中的可靠数据传输，是传输层实现的功能。

8.在下列情况下，计算传送1000KB文件所需的总时间，即从开始传送时起知道文件的最后以为到达目的地为止的时间。假设往返时间RTT为100ms，一个分组是1KB（即1024B）的数据，在开始传送整个文件数据之前进行的起始握手过程需要2RTT的时间。

（1）带宽是1.5Mb/s，数据分组可连续发送
（2）带宽是1.5Mb/s，但在发送完每一个数据分组之后，必须等待一个RTT，才能发送下一个数据分组
（3）假设带宽无限大，即发送时间为0，但是在等待每个RTT后可以发送多达20个分组

答：(1)：总时延 = 发送时延 + 传播时延 + 握手时延

发送时延 = 1000KB/1.5Mb/s = 5.46s	（注意单位换算）

> 1.5Mb/s=1.5x10^6^b/s=(1.5x10^6^/8)B/s=(1.5x10^6^/8/1024)KB/s

传播时延 = RTT/2=100ms/2 = 50ms
握手时延 = 2*RTT=200ms

总时延=5.46s+0.05s+0.2s=5.71s

> 发送时延可想象成豌豆射手吐完所有豌豆所需时间
>
> 传播时延是这些吐出来的豌豆去打僵尸的路上所花的时间

(2)：发送完一个分组等一个RTT，总共有1000个分组在(1)的基础上加上999RTT即可(发第1000个分组后就发完了不用再等了)。

总时延=5.71s+999x0.1s=105.61s

(3)：总时延 = 发送时延 + 传播时延 + 等待时延 + 握手时延

①发送时延本题为0，而握手时延为固定值2RTT

一共1000分组，一次能发20分组，需要发50次

②等待时延：从发第二次到第五十次发送前都要等一个RTT即49RTT

③传播时延：第一次发后数据需要0.5RTT才能到达目的地，但与此同时这0.5RTT时间内第二次发送也在等待一个RTT。

由于我们已经计算过等待时延，所以不用额外加上这些传播时延。

而第五十次发送后由于是最后一次发送所以需要加上0.5RTT的传播时延。

> t=0：第一次发送，t=0.5RTT第一次发送的数据到达目的地，t=1RTT，第二次发送数据，......t=49RTT，第五十次发送，t=49.5RTT，第五十次发送的数据到达目的地

所以总时延=2RTT+49RTT+0.5RTT=51.5RTT=5.15s

# 物理层

## 老师所画重点

1.物理层接口的基本特性
2.香农公式,信道中的极限信息传输速率和带宽及信噪比的关系
3.物理传输介质的分类(导引、非导引)及导引型传输介质的特性
4.通信的三种基本方式(单向通信、双向交替通信、双向同时通信)
5.信道复用技术的种类及其主要特征(FDM、TDM、WDM、CDMA等)。
6.CDMA的简单应用

## 知识点

1.物理层解决如何在各种传输媒体传输数据比特流，而不是指具体的传输媒体。(记住每个层都没有实体就ok)\

2.物理层主要任务：确定与传输媒体接口有关的一些特性(定义标准)

- 机械特性：规定所采用的规格、接口形状、引脚数量等情况。无对应
- 电气特性：规定传输过程中的电压范围、传输速率、距离限制等。对应语法
  - 如+10V ~ +15V 表示二进制数据 0 ，电线长度在15m以内
- 功能特性：描述 电平 的意义 , 接口部件 信号线用途。对应语义
  - 如一个接口的引脚处于高电平的含义
- 过程特性(规程特性)：规定各个物理线路工作规程 , 时序关系。对应同步 

3.基带传输对应数字信号(0和1用电压表示)，宽带传输对应模拟信号(连续变化的)

![image-20201212190029799](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201212190029799.png)

4.数据传输方式

- 串行传输：一个比特一个比特的传输（远距离常用）
- 并行传输：多个比特通过多个信道同时传输（近距离常用）

通信方式

- 同步通信：发送端和接收端的时钟频率相等(单位为帧)（技术复杂，效率高，贵）
- 异步通信：发送端发完一个发送单位即字节后，可过任意时间发下一个（价格低）

> 同步传输的帧头和帧尾占很少一部分可近似认为传输效率为100%，而异步传输每8bit就要加一个起始位和终止位，传输效率位80%，可得同步效率比异步效率要高

通信模式

- 单工：只有一个方向的通信，需一条信道（如广播）
- 半双工：双方都可以发或接，但不能同时发和接，需两条信道（如对讲机）
- 全双工：双方可同时发和接，需两条信道（如打电话）

5.码元：用一个固定时长的信号波形代表不同的离散数值的基本波形，而1码元可携带多个比特的信息

> 如二进制有两种码元即0和1，而4进制则有00、01、10、11四中码元

6.速率：即传输速率，有两种描述形式

- 波特率：也称码元速率，表示每秒可传输多少个码元，单位为波特(B)
- 比特率：也称信息传输速率，表示每秒可传输多少个比特，单位为比特每秒(b/s)

> 关系：若一个码元携带2bit信息，则3B波特率对应比特率为3x2 bit/s

7.带宽：单位时间内所能通过的最高数据率，单位比特每秒(bit/s)（数字信号中）

> 可理解为大马路有多宽

模拟信号中的带宽表示允许通过的最高频率减最低频率

8.奈氏准则：理想低通(**无噪声**、带宽受限)条件下，为了避免码间串扰(码元之间失去清晰界限)存在一个极限数据传输率
$$
Cmax=2*W*log2N (bit/s)
$$


> 其中W为带宽HZ，N为几种码元或每个码元的离散电平的数目
>
> 奈氏准则只给出了码元传输速率的限制并没有给出信息传输速率的限制
>
> f~采样~≥2f~信号最高频率~，而f~采样~=2*W

9.信号越强，噪声的影响就越小，因此只考虑其中一方是没有意义的，所以求信噪比才有意义

> 其中S为信号的平均功率，N为噪声的平均功率

$$
信噪比(dB)=10*log10(S/N) (dB)
$$

10.香农定理：在宽带受限且**有噪声**的信道中，为了不产生误差，信息的传输速率有上限值

> 其中W为带宽(Hz)，S/N需要由信噪比推出

$$
Cmax=W*log2(1+S/N) (bit/s)
$$

通过公式我们可知道

- 信道中宽带或信噪比越大，信息的极限传输速率越高
- 对于一定的带宽和信噪比，信息的传输速率上限就确定了
- 只要信息的传输速率低于极限传输速率，就一定能找到某种方法实现无差错的传输
- 实际信道的传输速率要比极限速率低不少

11.奈氏准则指出了码元传输的速率是受限的(内忧)，而香农定理给出了信息传输速率的极限(外患)

![image-20201212201158273](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201212201158273.png)

12.数据------------>数字信号		（编码）

数据------------>模拟信号		     （调制）

13.数字数据编码为数字信号

![image-20201213141647340](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201213141647340.png)

- 非归零编码(NRZ)：低电平为0，高电平为1，但无法判断码元的开始和结束，双方难以同步
- 翻转不归零编码(NRZI)：电平遇0翻转，遇1不变
- 曼彻斯特编码：每个码元内前高后低为1，前低后高为0，所占频带宽度是原始基带宽度的两倍(以太网用这个)
- 差分曼彻斯特编码：前半个部分的电平与上一个码元的后半部分电平相同时为1，抗干扰强

> 后两个都是用每个码元的中间跳变作为收发双发的同步信号

14.数字数据调制为模拟信号

![image-20201213141917786](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201213141917786.png)

15.模拟数据编码为数字信号：抽样、量化、编码

16.模拟数据调制为模拟信号：为了实现传输的有效性，有时需要较高的频率

17.数据传输(交换)方式

![image-20201213142711040](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201213142711040.png)

- 电路交换：双方需建立一条被双方独占的物理通路
  - 优点：通信时延小、实时性强、有序传输、适用范围广、控制简单、避免冲突
  - 缺点：建立连接时间长、通信利用率低、缺乏统一标准、灵活性差
  - 适用于传输数据量大且传送时间远大于呼叫时间
- 报文交换：无需建立专有线路，传输单位为报文，采用存储转发方式
  - 优点：无需建立连接、动态分配线路、提高可靠性、提高线路利用率、提供多目标服务
  - 缺点：存储转发会产生时延、只适用数字信号、报文大小没限制需节点有较大存储缓存空间
- 分组交换：仍采用存储转发但一个长报文分割成若干分组即限制所传输单位长度
  - 优点：加速传输、简化存储管理、减少出错概率和重发数据量
  - 缺点：仍存在存储转发时延、若采用数据报服务要进行编号排序若采用虚电路需有呼叫连接等过程
  - 适用于端到端的通路由很多段的链路组成

> 从信道利用率看，报文和分组交换优于电路交换，分组交换时延小，尤其适用于突发式的数据通信

18.分组交换可采用的两种方式

![image-20201213175034810](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201213175034810.png)

19.无连接和连接服务

无连接服务：不事先为分组的传输确定传输路径,每个分组独立确定传输路径,不同分组传输路径可能不同。

连接服务：首先为分组的传输确定传输路径(建立连接)，然后沿该路径(连接)传输系列分组,系列分组传输路径相同,传输结束后拆除连接。

20.传输介质：数据传输系统中双方之间的物理通路，在物理层下面，可称为0层。

- 导向性传输介质：沿着实实在在的线传播

  - 双绞线：由两根采用一定规则并排绞合的、相互绝缘的铜导线组成。价格便宜较常用。

    ![image-20201213180150736](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201213180150736.png)

  - 同轴电缆：由于外导体屏蔽层，其比双绞线抗干扰性能好，价格贵

  ![image-20201213180705742](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201213180705742.png)

  - 光纤：由纤芯(实心)和包层组成
    - **误码率低**，带宽大
    - 抗雷电和电磁干扰性能较好、不易被窃听和截取数据、体积小重量轻
    - 单模光纤衰减小适合远距离传输，多模光纤易失真适合近距离传输

- 非导向型传输介质：在自由空间中传播，如水、空气等

21.物理层设备

- 中继器：对数字信号进行再生和还原，对衰减的信号(传输过程会衰减到一定程度会失真)放大，以增加信号传输的距离。
- 集线器(Hub)：可理解为多口中继器，对信号进行再生放大转发，会转发到除输入端口外的所有工作端口，是一个共享式设备。

![image-20201213182206346](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201213182206346.png)

22.宽带和带宽的关系：如100M的宽带(名词)指这条宽带的带宽(量词指传输速率)为100Mbps,传输速率为12.5MB/s

## 习题

1.在无噪声的情况下,若某通信链路的带宽为3kHz,采用4个相位,每个相位具有4种振幅的QAM调制技术,则该通信链路的最大数据传输率是多少?

答：题目中说无噪声所以用奈氏准则求解

4个相位,每个相位具有4种振幅所以有16种状态即N=16

C~max~=2\*3k\*log~2~16=24kb/s（注意公式中带宽的单位为HZ）

> 也可以理解为带宽为3kHZ，则采样频率为6kHZ即每秒采样6k次，16种状态，则每个码元携带4bit信息，C~max~=每秒采样次数*每码元携带信息

2.电话系统的典型参数是信道带宽为3000Hz,信噪比为30dB,则该系统的最大数据传输率为（C）
A. 3kbit/s		B. 6kbit/s		C. 30kbit/s		D. 64kbit/s

答：电话系统的信道是有噪声的信道，所以用香农定理求解

香农公式用到了S/N，而我们已知了信噪比，先求S/N

10log~10~(S/N)=30，所以S/N=1000

C~max~ = 3000\*log~2~(1+S/N) = 3000\*log~2~(1+1000) ≈ 30kbit/s

> 注意S/N并不是信噪比，一般题目都是给信噪比我们要先求S/N

3.调制解调技术主要使用在（A）通信方式中。
A.模拟信道传输数字数据		B.模拟信道传输模拟数据
C.数字信道传输数字数据		D.数字信道传输模拟数据

答：调制就是将基带数字信号的频谱变换为适合在模拟信道中传输的频谱(比如数字数据调制为模拟信号)，解调正好与之相反(还原成数字数据)。

所以，调制解调技术用于模拟信道传输数字数据通信方式，而模拟信道传输模拟数据不需要调制解调技术

4.一个传输数字信号的模拟信道的信号功率是0.62W,噪声功率是0.02W,频率范围为3.5~39MHz,该信道的最高数据传输速率是（B）
A. IMbit/s		B. 2Mbit/s		C. 4Mbit/s		D. 8Mbit/s

答：信噪比S/N=0.62/0.02=31，带宽W=3.9MHZ-3.5MHZ=0.4MHZ

W*log2(1+S/N)=0.4MHZ\*log2(1+31)=2Mbit/s

> 注意信噪比和带宽的含义

5.为了使模拟信号传输得更远,可以采用的设备是（B）
A.中继器		B.放大器		C.交换机		D.路由器

答：要想传的远就要进行放大，而放大信号是物理设备应执行的功能，所以交换机(数据链路层)和路由器(网络层)都可以排除。

中继器和放大器都可以放大 信号，但中继器放大的是数字信号而放大器才能放大模拟信号。

6.因特网上的数据交换方式是（C）
A.电路交换	B.报文交换	C.分组交换	D.光交换

答：电路交换主要用于电话网，报文交换用于早期电报网，因特网使用的是分组交换。

> 助记：打电话按分钟(双方独享线路)计费，手机上网按流量(分组)计费

7.![image-20201214112513935](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201214112513935.png)

答：①每个分组大小为1000B，而分组头为20B，则每个分组数据部分为980B。所以980 000B应该被分为1000个分组，每个分组1000B，则一共传送1000 000B信息

> 特别注意类似于分组的头部，**头部**信息都是**后来加上去的**，相当于拿出来数据的一部分给它加个头部成一个分组。所以肯定不是980 000/1000得到980个分组的错误值

②链路传输速率100Mbit/s即100/8=12.5MB/s（1B=8bit）

③H1发完所有分组需要1000 000B / 12.5MB/s=80ms

此时刚好最后一个分组刚从H1发出去，最快是从上面直线过经过两次存储转发到达H2，用时2\*1000B/12.5MB/s=0.16ms

> 类似于流水线那种
>
> ![image-20201214114120084](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201214114120084.png)

综上，总用时为80ms+0.16ms=80.16ms

8.波特率和比特率之间的转换![image-20201214121555601](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201214121555601.png)

答：从图中可以看出有十六种状态，需要用log~2~16=4bit来表示这16种状态，2400Baud即每秒传2400码元，一个码元有4bit，则比特率为2400*4=9600bit/s

9.10Base-T指的是（B）

B.10Mbit/s，使用数字信号，使用双绞线

答：10表示每秒传10Mbit，Base(基础--->基带)表示基带传输即数字信号，T(Twisted-pair)表示用的是双绞线

10.下列关于单模光纤的描述中,正确的是（D）
A.单模光纤的成本比多模光纤的成本低
B.单模光纤传输距离比多模光纤短
C.光在单模光纤中通过内部反射来传播
D.单模光纤的直径一般比多模光纤小

答：单模在荒郊野外用传的远(贵)，多模在学校用传的近(便宜)

多模才用到内部反射，单模可理解为一条直线，而多模需要在通道内来回反射的传播所以多模直径更大

11.主机甲通过1个路由器(存储转发方式)与主机乙互联，两段链路的数据传输速率均为10Mbps，主机甲分别采用报文交换和分组大小为10kb的分组交换向主机乙发送1个大小为8Mb(1M=10^6^)的报文。若忽略链路传播延迟、分组头开销和分组拆装时间，则两种交换方式完成该报文传输所需的总时间分别为 (D)

A．800ms、1600ms 	B．801ms、1600ms 

C．1600ms、800ms 	D．1600ms、801ms

答：①当采用报文交换时，只需考虑两次发送时延，一次在主机甲，一次时在路由器，而每次的发送时延都为8Mbit/10Mbit/s=800ms，所以共需1600ms

②当采用分组交换时，每个分组为10kbit，发送时延为10kbit/10Mbit/s=1ms,共800个分组。

主机甲发送完所有分组需要800ms,发的最后一个还需经历一个路由器的存储转发所以再加上1ms，即最终结果为800ms+1ms=801ms

> 也可以理解为第一个分组需要两个发送时延，以后每一个发送时延都会有1个分组到达主机乙，即2ms+(800-1)*1ms=801ms
>
> 原理都是流水线，就看怎么理解了，怕出错可以手画一下

12.下列因素中，不会影响信道数据传输速率的是 （D）

A.信噪比	B.频率宽带	C.调制速率	D.信号传播速度

答：由香农定理得知信噪比和频率宽带都会对数据传输速率产生影响。

信道的**传输速率其实就是发送速率**，所以调制速度也会影响数据传输速率。

信号传播速度是在信道传播的速度，和发送率无关。

> 发送时延也称为传输时延，而传输速率也指的是发送速率，不是在信道上传输的速率！
>
> 实际上带宽等也都是和发送速率有关，传播速率一般都是固定的(如在光纤上传播)，我们研究的基本都是发送速率。

# 数据链路层

## 老师所画重点

1.数据链路层的三个基本问题(封装成帧、透明传输、差错检测)
2.点到点协议PPP及其透明传输的实现(同步传输)。
3.差错检测技术(CRC)
4.局域网的拓扑类型、特点等。

5.CSMA/CD协议的工作过程,及争用期、最短帧长等概念和应用。
6.以太网的MAC地址及帧格式中各字段的作用。

## 知识点

1.名词解释

- 链路：网络中两个结点之间的物理通路
- 数据链路：网络中两个结点之间的逻辑通道，即链路加上控制数据传输协议的硬件和软件
- 帧：链路层的协议数据单元，封装成网络层数据报

2.数据链路层的主要功能

- 链路管理：用于面向连接的服务即连接的建立、维持、释放
- 组帧
- 差错控制
- 透明传输

3.封装成帧：在一段数据前后加上首部(SOH即start of header)和尾部(EOT)，就成了一个帧。

> 只有既加头又加尾接收方收到后才能知道哪是开头哪是结尾
>
> 每一条链路协议都规定了所能传输帧的数据部分长度上限--最大传送单元MTU(maximum transfer unit)

4.透明传输：不管数据是什么比特组合都应能在链路上传送，若有部分数据和控制信息冲突就要采取适当措施

- 字符填充法：传送非ASCII码的文本时数据部分可能含有帧定界符SOH和EOT在数据部分的他们前面加上ESC(相当于转义'\\')

5.全世界使用最多的数据链路层协议就是点对点协议PPP，分为三部分

- 一个将IP数据报封装到串行链路的方法(成帧方法)
- 一个用来建立、配置和测试数据链路连接的链路控制协议LCP
- 一套网络控制协议NCP

各字段的意义为

![image-20201225235804734](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201225235804734.png)

当信息字段出现和标志字段一样的比特0X7E时要采取措施，当使用异步传输时采用字节填充法(转义)

当PPP用在SONET/SDH链路时使用同步传输，采用零比特填充实现透明传输

- 零比特填充法：发送端遇到5个连续的1就插入1个0，接收端逆操作遇到连续5个1就删除后面的0

PPP不需要的功能:纠错(PPP只负责检错)、流量控制(由TCP负责)、序号(PPP是不可靠传输协议,所以不需要对帧进行编号)、多点线路(PPP是点对点的通信方式)、半双工或单工(PPP只支持全双工链路)。

6.概括来说传输中的差错都是由于噪声引起的，差错可分为以下两种

- 位错：1变成0或0变成1
- 帧错：帧丢失、重复、失序

7.差错检测

- 检错编码

  - 奇偶检验码：奇检验就是加上1位检验位后1的个数为奇数，但只能检验奇数个比特出错。

  - **循环冗余码CRC**

    ![image-20201225204746513](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201225204746513.png)

    > 数据链路层仅仅使用CRC做到无差错接收(认为收到的都没出错)并没有向网络层提供可靠传输

- 纠错编码

  - 海明码
    - 满足2r-1 ≥ k+r（r位冗余检验码，k位信息位）
    - 若想检测d位错误，海明距为d+1
    - 若想纠正d位错误，海明距为2d+1

8.流量控制：较高的发送速度和较低的接收能力不匹配，会造成传输出错，因此要加以控制

- 数据链路层流量控制：接收方收不下就不回复确认（点对点）
- 传输层流量控制：接收端给发送端一个窗口公告（端到端）

> 流量控制和可靠传输机制在谢希仁版的第五章，此处采用所选参考资料顺序进行总结

9.流量控制方法

- 停止等待协议：发送方发完一帧后要等到收到应答信号才能继续发下一帧

  - 无差错时用1bit编号即可
  - 出错时：设置超时计时器，其重传时间要比帧传输的RTT更长一些，数据帧和确认帧要编号且要发完一个帧要保留副本
  - 简单但信道利用率太低
  - 发送窗口=1，接收窗口=1

- 后退N帧协议(GBN)：发送方发一个数据帧后不用停下等待确认帧而是继续发，如果某个帧出错，接收方**丢弃该帧及其以后的帧**

  - 发送窗口的大小应满足 1≤WT≤2^n^-1，过大会使得接收方无法区别新帧和旧帧（n位比特对帧编号）
  - 确认序列号最大、按序到达的帧
  - 因连续发送数据帧提高了信道利用率但重传时必须把已经正确传送的帧重传使得传送效率降低
  - 帧号大于等于发送窗口+1
  - 发送窗口>1，接收窗口=1

- 选择重传协议(SR)：若一帧出错，则其后续帧先存入接收方的缓冲区中，同时要求发送方重传出错帧，一旦收到重传帧，就和原先存在缓冲区的其余帧一起按顺序送至主机

  - 收到一个确定一个
  - 只传送出错帧
  - 最大发送窗口和最大接收窗口=2^n-1^（n位比特对帧编号）
  - 发送窗口>1，接收窗口>1 

  ![image-20201225213859717](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201225213859717.png)



> 接收窗口为1时一定可保证帧按序接收

10.复用和分用

![image-20201225215702847](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201225215702847.png)

11.介质访问控制：采取一定的措施，使得两对节点之间的通信不会互相干扰

- 信道划分介质访问控制（静态划分信道）
  - 频分多路复用FDM：用户在同一时间始终占用不同频率的带宽（并行）
    - 充分利用带宽效率高实现容易
  - 时分多路复用TDM(同步)：用户使用各自对应的时间间隙轮流使用信道（并发）
    - 可能导致线路资源的浪费
  - 统计时分复用STDM(异步)：改进版的TDM，不是固定分配时隙而是按需分配
  - 波分多路复用WDM：就是光的频分复用（如光纤中传输不同波长(频率)的光）
  - 码分多路复用CDMA：又称码分多址,既共享频率又共享时间（习题讲解具体步骤）
    - 每个站点对应一个m位的芯片序列。发送1时发送芯片序列，发0时发送序列反码
    - 任意两个站点芯片序列正交，规格化内积为0
    - 任一站点与自身规格化内积为1，与自身反码规格化内积为-1
    - 优点：抗干扰强、保密性强、语音质量好、减少成本
- 轮询访问介质控制（动态划分信道）
  - 典型的是令牌传递协议，令牌按环形传递，只有拿到令牌的才能发送数据
- 随机访问介质控制（动态划分信道）
  - 纯ALOHA协议：不监听信道、不按时间槽发送、随机重发也就是想发就发（不听就发）
    - 若发生冲突接收方不予确认，发送方一段时间收不到就判断发生冲突
    - 发生冲突后等以随机时间重传
    - 信道利用率低
  - 时隙ALOHA协议：划分若干时间片，必须在时间片开始时才可发送数据（不听就发）
    - 比纯ALOHA协议吞吐量大效率高
  - CSMA协议：即载波监听多路访问协议发送前先检测下是否有其它计算机在发数据（先听后发，边听边发）
    - 1-坚持CSMA：监听到信道空闲立即发送，否则一直监听
    - 非坚持CSMA：监听到信道空闲立即发送，否则等一个随机时间再监听
    - p-坚持CSMA：监听到信道空闲时，以概率p发送数据，以概率(1-p)延迟一段时间再监听
  - **CSMA/CD协议**：全称为带冲突检测的载波监听多路访问协议，广泛应用于局域网中
    - 工作过程：先听后发，边听边发，冲突停止，随机重发
    - 争用期：以太网端到端的往返时延2τ，若这段时间没检测到冲突那么这次发送肯定没有冲突
    - 最短帧长：以太网取51.2us为争用期的长度，10Mbit/s的以太网争用期内可发512bit即64B，所以以太网规定最短帧长为64B，若小于这个长度一定是由于冲突而异常终止的帧
    - 当重传16次仍然不成功说明网络太拥挤，则认为永远无法正确发出，抛弃此帧向高层报告

12.局域网(Local Area Network)：简称LAN，指某一区域内有多台计算机互联组成的计算机组，使用广播信道

![image-20201225233129778](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201225233129778.png)

13.以太网(Ethernet)：当今局域网采用的最通用的通信协议标准，采用CSMA/CD技术，无连接不可靠

![image-20201225233636424](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201225233636424.png)

- 前导码：可分为前同步码(使接收端和发送端时钟同步)和帧开始定界符
  - 由硬件生成插入到MAC帧前进行传输(不属于MAC帧的一部分)
  - 使用SONET/SDH进行同步传输时不需要前同步码
- IEEE 802.3g=规定8位源地址最后一位恒为0
- 类型：表明上层使用的协议，如0x0800代表上层使用的是IP数据报
- FCS：即检验码采用CRC，不检验前导码其他均检验

> 由于以太网传送帧时，各帧之间必须要有一定的间隙，所以接收端只要找到帧开始定界符即可确定一个连续的帧，因此MAC帧没有帧结束符
>
> 除上图中的标准还有一种IEEE802.3标准

14.MAC地址实际上就是适配器地址，适配器插入到计算机其标识符就成了MAC地址，而适配器有过滤功能

- 单播帧(一对一)：收到的帧的MAC地址与本站的硬件地址相同
- 广播帧(一对全体)：发送给本局域网上所有站点的帧(全1地址)
- 多播帧(一对多)：发送给本局域网上一部分站点的帧

> 以太网的适配器有种混杂模式，其可收下监听到的所有帧

15.虚拟局域网VLAN是由一些局域网网段构成的与物理位置无关的逻辑组

- 使用VLAN，交换机可将一个广播域划分，使得网络不会因传播过多广播信息(广播风暴)而引起性能恶化

16.网桥：根据MAC帧的目的地址进行转发和过滤

- 透明网桥：以太网上的站点并不知道所发送的帧将经过哪几个网桥，即插即用自学习
- 源路由网桥：发送帧时，将详细的最佳路由信息放到帧的首部

17.交换机：实质上时多端口网桥，一般全双工工作，**主机不会平分带宽**

- 每个端口都直接和一个主机或另一个集线器相连避免了碰撞，且都是一个冲突域
- 根据MAC地址转发

18.冲突域和广播域

![image-20201226002509072](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201226002509072.png)

| 设备   | 区别                                 |
| ------ | ------------------------------------ |
| 路由器 | 可以互联两个不同网络层协议的网段     |
| 网桥   | 可以互联两个物理层和链路层不同的网段 |
| 集线器 | 不能互联两个物理层不同的网段         |

19.理想条件下，信道利用率=发一帧时间/(发一帧时间+一个端到端时延)

## 习题

1.某个CDMA站接收方收到一条碎片系列:(-1+1-3+1-1-3+1+1)
假设各个站点的码片向量如下:
站点A:(-1-1-1+1+1-1+1+1)		站点B:(-1-1+1-1+1+1+1-1)
站点C:(-1+1-1+1+1+1-1-1)		站点D:(-1+1-1-1-1-1+1-1
问哪些站点发送了数据?分别发送了什么数据?

答:只需将接收到的碎片序列分别与站点A、B、C、D的码片向量进行规格化内积即可。

内积为1表示发送了比特1,内积为-1表示发送了比特0，内积为0表示没有发送数据
站点A:(-1+1-3+1-1-3+1+1)·(-1-1-1+1+1-1+1+1)/8=1。
站点B:(-1+1-3+1-1-3+1+1)·(-1-1+1-1+1+1+1-1)/8=-1。
站点C:(-1+1-3+1-1-3+1+1)·(-1+1-1+1+1+1-1-1)/8=0
站点D:(-1+1-3+1-1-3+1+1)·(-1+1-1-1-1-1+1-1)/8=1。
因此,站点A和站点D发送了比特1,站点B发送了比特0,站点C没有发送数据。

2.某以太网交换机具有24个100Mbis的全双工端口与2个1000 Mbit/s的全双工端口,其总带宽最大可以达到(D)
A. 0.44Gbit/s		 B. 4.4Gbit/s
C. 0.88Gbit/s 		D. 8.8Gbit/s
解析:因为是全双工,总带宽=24×100Mbis×2+2×1000Mbit/sx2=8800Mbit/s=8.8Gbit/s。

若此题改为半双工,则答案为B。
交换机最大的优点是不仅其每个端口节点所占用的带宽不会因为端口节点数量的增加而减少,而且整个交换机的总带宽会随着端口节点的增加而增加。

3.在OSI参考模型中,下面哪些是数据链路层的功能?(A)
Ⅰ.帧同步	II.差错控制	Ⅲ.流量控制	Ⅳ.拥塞控制
A.I、Ⅱ和Ⅲ		B.I、Ⅱ和Ⅳ
C.I、Ⅲ和Ⅳ		D.Ⅱ、Ⅲ和Ⅳ

答：在OSI模型中数据链路层有流量控制和差错控制的功能，而在TCP/IP模型中这两个功能交给了传输层。而无论哪一个模型，帧同步都是数据链路层的，拥塞控制都是传输层的。

4.发送方准备发送的信息位为1101011011,采用CRC校验算法,生成多项式为G(x)=x^4^+x+1,那么发出的校验位应该为（D）
A.0110	B.1010	C.1001	D.1110

答：生成多项式为x^4^+x+1，那么检验码为10011

1101 0110 11 0000 % 10011 =1110

> 第一步先加0，x最高4次方那就加4个0

5.假设数据链路层采用后退N帧协议进行流量控制,发送方已经发送了编号为0~6
号的帧。当计时器超时时,2号帧的确认还没有返回,则发送方需要重发的帧数是(B)
A.1	B.5	C.6	D.7

答：因为2号帧没返回确认所以要将2号及以后的所有帧均重发，23456即5个

后退N帧协议没收到一个就要把它和它之后的都重发使得效率降低，而选择重传哪个出错就只重传那个就可以

6.根据 CSMA/CD协议的工作原理,需要提高最短帧长度的是（D）
A.网络传输速率不变,冲突域的最大距离变短
B.上层协议使用TCP的概率增加
C.在冲突域不变的情况下减少线路的中继器数量
D.冲突域的最大距离不变,网络传输速率提高

答：最小帧长=数据传输速率*往返时延

最小帧若想变大，那么可以提高传输速率或者提高时延。A中距离变短会使得往返时延也降低

> 由公式可以看出，最小帧长与距离和速率成正比

7.在以太网的二进制后退算法中,在4次碰撞之后,站点会在0和（C）之间选择一个随机数
A.7	B.8	C.15	D.16

答：10次以内：2^i^-1。10次以上：2^10^-1=1023

8.一个通过以太网传送的IP分组有60B长,其中包括所有头部。若没有使用LLC
则以太网帧中需要（C）填充字节。
A.4字节	B.144字节	C.0字节	D.64字节

答：以太网最小帧为64字节。其中帧的目的地址+源地址+类型+FCS已经占了18字节，加上帧的数据部分(整个IP分组就是帧数据部分)已经达到了60+18=78字节的长度，因此不需要再填充字节。

9.下列介质访问控制方法中,可能发生冲突的是（B）
A. CDMA	B.CSMA	C. TDMA	D. FDMA

答：码分多路复用CDMA、时分多路复用TDMA和频分多路复用FDMA都属于信道划分介质访问控制，相当于一人一个专用道肯定不会发生冲突。

而对于随机访问介质来说可能就会发生冲突，如CSMA、CSMA/CD等

10.主机甲与主机乙之间使用后退N帧协议（GBN）传输数据，甲的发送窗口尺寸为1000，数据帧长为1000字节，信道宽带为100Mbps，乙每收到一个数据帧立即利用一个短帧（忽略其传输延迟）进行确认，若甲乙之间的单向传播延迟是50ms，则甲可以达到的最大平均数据传输速率约为（C）

A.10 Mbps	B.20 Mbps	C.80 Mbps	D.100 Mbps


答：甲的发送窗口为1000，也就是发完第一个帧之后在收到该帧的确认前最多能再发999个帧。不考虑带宽要想传输速率最大就要把这999帧都发出去而收到确认时延为2*50ms=0.1s，也就是说大约0.1s内发送1000x1000B=1MB数据。

V=1MB/0.1s=10MB/s=80Mbit/s

最终结果为min{100Mbit/s，80Mbits/s}=80MBit/s

> 注意这里的最大传输速率是指豌豆射手吐豌豆的速率

11.站点A、B、C通过CDMA共享链路,A、B、C的码片序列(chipping sequence)分别是(1,1,1,1)、(1,-1,1,-1)和(1,1,-1,1)。若C从链路上收到的序列是(2,0,2,0,0,-2,0,-2,0,2,0,2),则C收到A发送的数据是（B）
A.000	B.101	C.110	D.111

答：将收到的序列分为三组分别为(2,0,2,0)、(0、-2、0、-2)、(0、2、0、2)分别与A的码片序列做内积运算

(2,0,2,0)*(1,1,1,1)/4=1

(0、-2、0、-2)*(1,1,1,1)/4=-1

(0、2、0、2)*(1,1,1,1)/4=1

所以A收到的数据为101

12.决定局域网特性有3个主要技术分别为（传输介质、拓扑结构和介质访问控制方法）

# 网络层

## 老师所画重点

1.网络层提供的两种服务方式及特点
2.网络互联的概念、设备、层次、协议
3.IP地址的组成、分类
4.子网的划分(子网数、主机数、子网号、子网掩码等)和CIDR的基本概念及应用(路由聚合、地址块分配、地址数、掩码等)
5.IP数据报格式,各字段的含义及作用
6.ARP协议的基本概念和应用,IP地址和MAC地址的区别
7.ICMP报文类型、作用
8.IGMP的作用
9.路由器的构成,路由器转发分组的流程,路由表的构建
10.路由协议的分类,路由算法的含义和应用
11.IPv6地址格式

## 知识点

1.网络层提供的两种服务

![image-20201213175034810](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201213175034810.png)

2.网络层功能

- 异构网络互联：IP协议使得性能各异的网络形成一个虚拟互联网络，使得看起来好像是一个统一的网络

- 路由选择(确定哪一条路径)与分组转发(从合适的端口转发出去)
- 拥塞控制：结点都来不及接收分组而丢弃大量分组，此时就处于拥塞状态要采取措施缓解
  - 开环控制：事先考虑发生拥塞的因素，运行后不再修改（静态）
  - 闭环控制：即使检测然后报告拥塞再调整措施（动态）
  - 拥塞控制考虑全局，而流量控制只考虑发送端和接收端

3.IPV4分组

![image-20201228084343061](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201228084343061.png)

- 版本：占4位，指明IP数据报是IPv4还是IPv6，通信双方需保持一致
- 首部长度：占4位，单位是4B，最大值1111时最大表示60B
  - 实际首部60B，但有40B基本不用，所以做题**默认首部20B**
- 区分服务：占1B，指期望获得哪种类型的服务
- 总长度：占2B，单位为1B，就是首部+数据的长度
- 标识：占2B，同一数据报的分片使用同一标识
- 标志：占3位，目前只有前2位有意义
  - MF(More Fragment)：分割后表该分片后面还有没有分片，1为真表后面还有分片
  - DF(Don't Fragment)：表不能分片吗？1为真表不能分片
- 片偏移：占13位，单位是8B，表分片后该片在原分组的相对位置
- 生存时间(Time To Live--TTL)：占8位，防止数据报在网络中一直转圈，表可通过的最大路由器数
- 协议：占8位，携带数据部分的协议，以便让接收方直到应该用交给谁处理(如交给TCP)
- 首部检验和：占16位，注意**只检验数据报首部**不检验数据部分
- 源地址：占32位，表发送端主机的IP地址
- 目的地址：占32位，表接收端主机的IP地址
- 填充：首部长度单位为4B，若不是4B倍数就要填充成4B倍数

> 一种八片首饰（总长度单位1B，片偏移单位8B，首部长度单位4B）
>
> 得到目标IP后要转成MAC地址，因为MAC地址才是数据链路层和物理层使用的地址，可理解为它不认识IP地址
>
> 虚拟分组(Virtual Packet)就是IP数据报

2.分类的IP地址

格式：{网络号,主机号}采用点分十进制如10.12.26.178，32位

![image-20201228092559704](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201228092559704.png)

| NetID网络号 | HostID主机号 | 作为IP分组源地址 | 作为IP分组目的地址 | 用途                                                         |
| ----------- | ------------ | ---------------- | ------------------ | ------------------------------------------------------------ |
| 全0         | 全0          | 可以             | 不可以             | 本网范围内表示主机，路由表中用于表示默认路由（表示整个Internet网络） |
| 全0         | 特定值       | 可以             | 不可以             | 表示本网内某个特定主机                                       |
| 全1         | 全1          | 不可以           | 可以               | 本网广播地址（路由器不转发）                                 |
| 特定值      | 全0          | 不可以           | 不可以             | 网络地址，表示一个网络                                       |
| 特定值      | 全1          | 不可以           | 可以               | 直接广播地址，对特定网络上的所有主机进行广播                 |
| 127         | 非全0或非全1 | 可以             | 可以               | 用于本地软件环回测试，称为环回地址                           |

3.私有IP地址

私有IP地址只能用于局域网，无法在internet使用，如最常见的192.168.0.1

| 地址类别 | 地址范围                    | 网段个数 |
| -------- | --------------------------- | -------- |
| A类      | 10.0.0.0~10.255.255.255     | 1        |
| B类      | 172.16.0.0~172.31.255.255   | 16       |
| C类      | 192.168.0.0~192.168.255.255 | 256      |

> 事实上我们的手机电脑都可以连网但他们并不在因特网上，查看ip会发现都是私有地址

4.网络地址转换NAT(Network Address Translation)：NAT将专用网内部使用的IP转换成有效的全球IP使得专用网内只需一个全球IP就可以和因特网连通

- 在专用网连接到因特网的路由器上安装NAT软件，安装了NAT软件的路由器叫NAT路由器，它至少有一个有效的外部全球IP地址。

- NAT节省了IP的消耗，但没增加IP个数，真正解决IP耗尽问题的是IPv6

5.子网划分

- 原因：IP地址空间利用率又是很低且两级IP地址不够灵活
- 将两级地址划为三级即IP地址={网络号,子网号,主机号}
  - 划分子网后，对外仍表现为一个网络，即本单位外的网络看不见本单位内子网的划分

6.子网掩码：可以告诉主机或路由器是否对网络进行了子网划分

- 对应IP地址中的网络号和子网号位置为全1，主机号位置为全0
- 不管有没有划分子网，只要将子网掩码和IP地址相与就一定能得到网络地址

7.使用了子网掩码后的路由转发分组算法

- 提取目的IP地址
- 是否直接交付
- 特定主机路由
- 检测路由表中有无路径
- 默认路由 0.0.0.0
- 丢弃，报告转发分组出错

8.无分类编址CIDR：ip地址后加上"/"，然后写上网络前缀位数

- 为解决IP地址耗尽而提出的一种措施
- 消除了传统的A类，B类和C类地址以及划分子网的概念
- 融合子网地址与子网掩码，方便子网划分，把网络前缀都相同的连续的IP地址组成一个"CIDR地址块"

9.路由聚合(构成超网)：将多个子网聚合成一个较大的子网

- 方法：将网络前缀缩短即所有网络地址取交集

10.最长前缀匹配：使用CIDR查路由表(与网络掩码相与)时可能得到多个匹配结果，应选择网络前缀最长的那个

- 原因：前缀越长，地址块越小，路由越具体
- 快递可以送到你的小区，也可以送到你家门口(更具体)，那当然是选择送家门口了

11.ARP协议：完成主机或路由器IP地址到MAC地址的映射，解决下一跳走哪的问题

- 出现原因：在链路上传送数据帧时，必须要使用MAC地址
- 使用过程：检查ARP高速缓存，有对应项则写入MAC帧，没有则用目的MAC地址为FF-FF-FF-FF-FF-FF的帧封装并**广播ARP请求分组**，同一局域网中所有主机都能收到该请求。目的主机收到请求后就会向源主机**单播一个ARP响应分组**，源主机收到后将此映射写入ARP缓存（10-20min更新一次）
- 4种典型情况（地址解析自动进行）
  - ARP找到本地主机B的硬件地址
    - 主机A发给本网络的主机B
    - 路由器发给本网络的主机B
  - ARP找到本网络上的一个路由器的硬件地址，剩下的由路由器完成
    - 主机A发给另一网络的主机B
    - 路由器发给另一网络的主机B
  - 总结：发给本网络就找本地对应主机的硬件地址，发给另一网络就找路由器的硬件地址

12.动态主机配置协议DHCP：提供即插即用连网的机制，主机可从服务器动态获取IP地址等信息。

- 属于应用层协议，使用客户/服务器方式

- 客户端和服务端通过广播方式交互，基于UDP

- 支持地址重用、移动用户加入网络、在用地址续租

- 客户端和服务端交换过程如下

  - 主机广播DHCP发现报文：试图找到网络中的服务器，服务器获得一个IP地址
    - 即主机喊了一声："有没有DHCP服务器呀？"
  - DHCP服务器广播DHCP提供报文：服务器拟分配给主机一个IP地址及相关配置
    - 多个服务器回答："有的有的，我发给你IP地址用我的吧"
  - 主机广播DHCP请求报文：主机向服务器请求提供IP地址
    - 主机继续问："你们哪个先到我就用哪个，那我用啦？"
  - DHCP服务器广播DHCP确认报文：正式将IP地址分配给主机
    - 服务器回答："好的好的，你用吧"

  13.网际控制ICMP协议：为了更有效的转发IP数据报和提高交付成功的机会

  > 可理解为哪地方错了你告诉我一声我好改 或者 我有事要问问你

  - ICMP差错报文

    - 终点不可达：无法交付时向源点发
    - 源站抑制：拥塞丢数据时向源点发
    - 时间超过：路由器收到生存时间TTL=0的数据报，向源点发送该报文
    - 参数问题：收到的数据报首部字段有问题时向源点发
    - 改变路由(重定向)：可以选择更好的路由，向源点发

  - 不应发送ICMP差错报文的情况

    - 对ICMP差错报文不再发送iCMP差错报文
    - 对第一个分片的数据报片的所有后续数据报片都不发送ICMP差错报告报文
    - 对具有组播地址的数据报都不发送ICMP差错报告报文
    - 对具有特殊地址（如127.0.0.0或0.0.0.0）的数据报不发送ICMP差错报告报文

  - ICMP询问报文

    - 有回送请求和回答报文：测试目的站是否可达以及了解其相关状态
    - 时间戳请求和回答报文：请某个主机回答当前时间，用来时钟同步和测量时间
    - 掩码地址请求和回答报文
    - 路由器询问和通告报文

  - 应用

    - ping：测试两个主机的连通性，使用了ICMP回送请求和回答报文
    - tracert：跟踪一个分组从源点到终点的路径，使用了ICMP时间超过差错报文报文

  - ICMP报文格式

    - 根据ICMP报文类型源主机就知道发生了什么故障了
    - ICMP报文是放在IP数据报中的数据部分，组成IP数据报发送出去

    ![image-20201228165533997](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201228165533997.png)

    - 根据IP数据报的首部就知道是哪个数据报错了
    - ICMP前8字节相当于ICMP的首部，对应上图的64位即最上面两行部分

    - 而IP数据报数据部分前8个字节也要放入ICMP报文因为该8个字节包含了TCP(也可能是UDP,下同)报文首部中的TCP端口号，这样源主机和用户进程有了端口才能更好的联系起来

    ![image-20201228165601583](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201228165601583.png)

14.IPv6：由于IPv4即将耗尽且NAT和CIDR都没从根本上解决耗尽问题，为此诞生出IPv6从根本解决耗尽问题

- 更大的地址空间：从32位增加到128位
- 扩展的地址层次结构：地址多了自然可划分更多层次
- 将IPv4的检验和字段移除以减少每跳的处理时间
- 取消协议字段改为下一个首部字段
- 取消总长度字段改为有效载荷长度字段
- 取消服务类型字段
- 将IPv4的可选字段移除首部变成扩展首部，首部更加灵活，路由器通常不检查扩展首部
- 允许协议继续扩充
- 支持即插即用（自动配置），不需要DHCP协议
- 支持资源的预分配，支持实时影像等要求
- 首部长度必须是8B的倍数而非IPv4的4B的倍数

15.IPv6数据报格式

![image-20201228201932828](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201228201932828.png)

- 版本：占4位，指明协议版本，对于IPv6，该字段为6
- 优先级：占8位，区分不同IPv6类别或优先级，0-15优先级依次增大，0-7表允许延迟，8-15表高优先级需固定速率传输
- 流标签：占20位，所有属于同一个流的数据报具有相同的流标签
- 有效载荷长度：占16位，指明IPv6除基本首部以外的字节数，最大值为64KB
- 下一个首部：占8位，相当于IPv4的协议字段或可选字段
- 跳数限制：占8位，没经过一个路由器减1值为0时丢弃该数据报（TLL换了个名字）
- 源地址：占128位，数据报发送方的IP地址
- 目的地址：占128位，数据报接收方的IP地址

16.IPv6用冒号十六进制表示：每16bit用一个十六进制数表示，各值用冒号分隔

- 如4BF5:AA12:0216:FEBC:BA5F:039A:BE9A:2170
- 缩写法
  - 4BF5:0000:0000:0000:BA5F:039A:000A:2176--》4BF5:0:0:0:BA5F:39A:A:2176
- 零压缩：一连串连续的0可以被一对冒号取代但双冒号表示法一个地址仅能出现一次双冒号
  - FF05:0:0:0:0:0:0:B3--》FF05::B3

17.IPv6基本地址类型

- 单播：一对一通信，可做源地址+目的地址
- 多播：一对多通信，可做目的地址
- 任播：一对多中的一个通信，可做目的地址

18.IPv4向IPv6过渡的策略

- 双栈协议：一台设备上同时启用IPv4协议栈和IPv6协议栈
- 隧道技术：隧道协议将其它协议的数据帧或包重新封装然后通过隧道传输

19.路由算法

- 静态路由算法(非自适应路由算法)：管理员手动配置路由信息
  - 路由更新慢，不适合大型网络
- 动态路由算法：路由器间彼此交换信息，按照路由算法优化出路由表项
  - 全局性：所有路由器掌握完整的网络拓扑和链路费用信息，如OSPF
  - 分散性：路由器只掌握物理相邻的；邻居及链路费用，如RIP
  - 特点：算法复杂，增加网络负担

20.自治系统AS：一个AS内的所有网络都属于一个行政单位管辖，内部使用AS内部的路由选择协议

- 诞生原因：因特网规模很大
- 很多单位不想让外界知道自己的路由选择协议，但还想进入因特网

21.路由选择协议

- 内部网关协议IGP：在一个自治系统内使用，如RIP和OSPF
- 外部网关协议EGP：不同自治系统间使用，如BGP

> 网关和路由器是同义词，可按路由器理解

22.RIP协议：分布式的基于距离向量的路由选择协议，最大优点是简单

- 要求每个路由器维护从它自己到其它每个目的网络的唯一最佳距离记录
  - 距离：即跳数，从源端口到目的端口所经历的路由器个数
  - 注意距离为16时表示网络不可达
- 和谁交换，多久交换一次，交换什么内容
  - 仅和相邻路由器交换信息
  - 交换信息内容为自己所知道的全部信息即自己的路由表
  - 按固定间隔(如30s)交换路由信息
  - 传送方式：UDP
- 收敛：路由器第一次工作只知道自己相邻距离即1而经若干次更新后，所有路由器都会知道任一个网络的最短距离和下一跳地址
- 只适用于小的互联网（大的网络路由器数量肯定远远大于15个）

23.RIP协议格式

![image-20201228212747369](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201228212747369.png)

24.RIP协议特点：好消息传的快，坏消息传的慢

- 当网络出现故障时，要经过比较长的时间(如数分钟)才能将此信息传送到所有的路由器(慢收敛)
  - 若一个网络出现故障可能两个路由器不断更新路由表直到距离为16才知道不能到达那个损坏的网

25.距离向量算法：解决使用RIP协议的路由表怎么更新的问题

![image-20201228212310617](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201228212310617.png)

一个小例题帮助理解

![image-20201228212614653](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201228212614653.png)

26.开放最短路径优先OSPF协议：使用分布式的链路状态协议

- 和谁交换：使用洪泛法向自治系统内所有路由器发送信息（广播）
- 交换什么：与本路由器相邻的所有路由器的链路状态（路由器所知道的部分信息）
- 多久交换：只有链路状态发生变化时，路由器才向所有路由器洪泛发送此消息
- 传送方式：IP（由于要交换信息较大不适合用传输层协议）
- 最终所有路由器都能建立一个链路状态数据库即全网拓扑图
- 为了使OSPF能用于很大的网络，将自制系统划分为若干范围，叫做区域

27.边界网关协议BGP：在不同自治系统之间交换信息，使用路径-向量路由选择协议

- 和谁交换：与其它AS的邻站BGP发言人交换信息
- 交换什么：交换网络可达性信息，即要到达某个网络所要经历的一系列自治系统
- 多久交换：发生变化时更新有变化的部分
- 传送方式：TCP
- 四种报文
  - OPEN(打开)报文：用来和相邻的另一个BGP发言人建立关系，并认证发送方
  - UPDATE(更新)报文：通告新路径或撤销原路径
  - KEEPALIVE(保活)报文：无更新时周期性验证邻站的连通性，也作为OPEN的确认
  - NOTIFICATION(通知)报文：报告先前报文的差错，也被用于关闭连接

28.三种路由协议对比

![image-20201228220304625](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201228220304625.png)

![image-20201228220319735](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201228220319735.png)

![image-20201228220343383](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201228220343383.png)

29.单播和组播(也称广播)

- 单播：发送者和每一个接收者之间都需要单独的数据信道（10个接收者那就要发10份数据）
- 组播：源主机只发一份数据，目的地址为组播地址，传输数据遇到如路由器时才会将数据复制继续转发
  - 组播地址范围为部分D类地址，不能用作源地址
  - 尽最大努力交付，不提供可靠交付
  - 对组播数据不产生ICMP差错报文

30.网际组管理协议IGMP：让路由器直到本局域网上是否有主机参加或退出了某个组播组

- 某主机若想加入组播组，向组播地址发IGMP报文声称想要加入
- 本地组播路由器收到后利用组播路由选择协议把这组成员关系发到因特网其它组播路由器
- 本地组播路由器周期性探寻本地局域网主机，以便知道这些主机是否还是组播成员
  - 组内只要有一个主机响应则认为这个组是活跃的，若几次探寻都无主机回应则不再把这组成员关系发给其他组播路由器
- 目的是找出以源主机为根节点的组播转发树(树可避免兜圈子)
- IGMP和ICMP一样都使用IP数据报传递报文

31.移动IP：移动结点以固定的网络IP地址，实现跨越不同网段的漫游功能，并保证网络权限不会改变

- 移动结点：具有永久IP地址的移动设备

- 归属(本地)代理：有一个端口和移动节点本地链路相连的路由器，根据移动用户的转交地址采用隧道技术转交其数据报

- 永久地址(主地址)：移动站点在归属网络中的原始地址

- 外部代理：移动结点漫游链路上的路由器，通知本地用户代理自己的转交地址，是移动结点漫游链路的默认路由器

- 转交地址(辅地址)：可以是外部代理的地址或动态配置的一个地址

- 通信过程

  - 移动结点在外部代理登记注册一个转交地址

  - 新外部代理发送注册报文给归属代理

  - 归属代理将移动结点的永久地址和转交地址绑定，以后要发送给移动结点的数据报被封装以隧道方式发给永久地址，返回注册响应报文

  - 外部代理收到注册响应，转发给移动结点

    > 你去学校(外部网络)上学，有人给你发信寄到你家(归属网络)，你妈妈(归属代理)拿着信去学校交给你
    >
    > 也就是你要是在家就直接交给你，但你不在家就要有个中间人转交给你

32.路由器：一种具有多个输入和输出端口的专用计算机，任务是连接不同的网络转发分组

路由器的结构如下

![image-20201228233119198](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201228233119198.png)

> 路由器的输入或输出队列产生溢出是造成分组丢失的重要原因

33.路由表由路由选择算法得出，主要用于路由选择，用软件来实现

![image-20201228233901800](https://cdn.jsdelivr.net/gh/zss192/Typora-notes@master/images/image-20201228233901800.png)

来了一个分组，就要根据路由表将其转发出去

- 将该目的IP分别与路由表子网掩码相与(二进制)，看结果是否有和表中的目的网络相同的
  - 若有相同的按表中转发端口和吓一跳将其转发出去
  - 若都没有相同的就按照图中最后一行的默认路由转发出去

> 默认路由：根据目的地址在路由列表中没有匹配的路由时就交给默认路由，再由它交给另一个路由

## 习题

1.





# 传输层

## 老师所画重点

1.运输层两个主要协议(UDP和TCP)的特点，提供的功能

2.TCP发送窗口机制

3.TCP连接建立

4.TCP的拥塞控制算法及应用

## 知识点

1.

## 习题

1.





# 应用层

## 老师所画重点

1.DNS的基本概念、作用及解析过程
2.FTP的基本概念及两个连接机制
3.万维网的基本概念，URL的格式
4.电子邮件系统的构成、协议，SMTP通信的三个阶段

| 协议                         | 调用 | 熟知端口 | 核心方式                  |
| ---------------------------- | ---- | -------- | ------------------------- |
| DNS                          | UDP  | 53       | 查询方式                  |
| FTP                          | TCP  | 21,20    | 两个连接                  |
| DNS                          | UDP  | 53       | 查询方式                  |
| FTP                          | TCP  | 21,20    | 两个连接                  |
| TFTP                         | UDP  | 69       |                           |
| TELNET                       | TCP  | 23       | VNT                       |
| SMTP <br/>POP IMAP <br/>MIME | TCP  | 25,110   | 多协议协同                |
| HTTP                         | TCP  | 80       | 工作流程                  |
| DHCP                         | UDP  | 67       | 即插即用连网,自动获取参数 |

## 知识点

1.

## 习题

1.



























































